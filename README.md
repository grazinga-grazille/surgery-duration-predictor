# Surgery Duration Predictor ðŸ¥

A machine learning application that predicts surgical procedure duration using a Random Forest model trained on ~35,000 historical OR cases from a Canadian teaching hospital (2019â€“2024).

Built as part of the **MSCI 623** capstone at the **University of Waterloo**.

---

## Live Demo

> **[Launch the Streamlit App](https://your-app.streamlit.app)** â† update this link after deploying

---

## Features

- **Predict** surgery duration from procedure description, room, specialty, and priority
- **Compare** model prediction against originally booked duration
- **Explore** model performance metrics and top feature importances
- **Interactive** sidebar inputs with instant results

---

## How It Works

| Step | Details |
|------|---------|
| **Input** | Procedure description (free text), OR room, specialty, patient type, surgical priority |
| **Text features** | TF-IDF bigrams â†’ TruncatedSVD (150 components, ~91.6% variance) |
| **Categorical features** | One-hot encoded: patient type, room, specialty |
| **Model** | Random Forest Regressor (100 trees, max depth 15) |
| **Target** | log(actual duration in minutes) â€” exponentiated at prediction time |

**Test-set performance:**
- RÂ² â‰ˆ 0.XX
- RMSE â‰ˆ XX min
- MAE â‰ˆ XX min

*(metrics are printed when you run `train_and_save.py`)*

---

## Setup

### 1. Clone the repo
```bash
git clone https://github.com/your-username/surgery-duration-predictor.git
cd surgery-duration-predictor
```

### 2. Install dependencies
```bash
pip install -r requirements.txt
```

### 3. Add your data
Place the raw Excel file in the project root:
```
UoWFinalizedDatasetMk6-20190401-20240401.xlsx
```
> The data file is excluded from version control (`.gitignore`) because it contains sensitive health information.

### 4. Train the model
```bash
python train_and_save.py
```
This saves all model artifacts to `models/`.

### 5. Run the dashboard
```bash
streamlit run app.py
```

---

## Deploying to Streamlit Community Cloud

1. Push this repo to GitHub (with the `models/` folder included).
2. Go to [share.streamlit.io](https://share.streamlit.io) and connect your repo.
3. Set the main file to `app.py`.
4. Deploy â€” no server setup required.

---

## Project Structure

```
.
â”œâ”€â”€ app.py               # Streamlit dashboard
â”œâ”€â”€ train_and_save.py    # Training pipeline â€” run once to generate models/
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ README.md
â””â”€â”€ models/              # Generated by train_and_save.py
    â”œâ”€â”€ rf_model.pkl
    â”œâ”€â”€ tfidf.pkl
    â”œâ”€â”€ svd.pkl
    â”œâ”€â”€ feature_columns.pkl
    â”œâ”€â”€ categorical_values.pkl
    â”œâ”€â”€ model_stats.pkl
    â””â”€â”€ importance_df.pkl
```

---

## Author

**Gatik Gola** Â· MSCI 623 Â· University of Waterloo
